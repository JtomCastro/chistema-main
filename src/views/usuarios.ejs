<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gestión de Usuarios</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <style>
      body {
        background-color: #f8f9fa;
      }
      .container {
        max-width: 1000px;
      }
      h2 {
        font-weight: 600;
      }
      /* Botones rectos y tamaño uniforme */
      .btn-accion {
        border-radius: 0 !important;
        min-width: 110px; /* ancho fijo para todos los botones */
        padding: 0.35rem 0.6rem;
        font-size: 0.9rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      /* Iconos en botones con algo de margen derecha */
      .btn-accion i {
        margin-right: 5px;
        font-size: 1.1rem;
      }
      /* Mejorar vertical alignment tabla */
      td,
      th {
        vertical-align: middle !important;
      }
      /* Responsive para móviles: tabla scroll */
      @media (max-width: 576px) {
        .table-responsive {
          overflow-x: auto;
        }
        td,
        th {
          white-space: nowrap;
          font-size: 0.85rem;
          padding: 0.3rem 0.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <h2 class="mb-4 text-center">Usuarios Registrados</h2>
      <div class="table-responsive shadow rounded bg-white">
        <table class="table table-bordered table-striped align-middle mb-0">
          <thead class="table-dark text-center">
            <tr>
              <th>ID</th>
              <th>DNI</th>
              <th>Nombre</th>
              <th>Email</th>
              <th>Rol</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <% usuarios.forEach(usuario => { %>
            <tr>
              <td class="text-center"><%= usuario.id %></td>
              <td class="text-center"><%= usuario.dni %></td>
              <td><%= usuario.nombre_usuario %></td>
              <td><%= usuario.email %></td>
              <td class="text-center text-capitalize"><%= usuario.rol %></td>
              <td class="text-center">
                <% if (usuario.estado === 'activo') { %>
                <span class="badge bg-success">Activo</span>
                <% } else { %>
                <span class="badge bg-secondary">Pendiente</span>
                <% } %>
              </td>
              <td class="text-center">
                <% if (usuario.estado === 'activo') { %>
                <form
                  action="/usuarios/<%= usuario.id %>/desactivar"
                  method="POST"
                  class="d-inline"
                >
                  <button
                    class="btn btn-warning btn-accion"
                    type="submit"
                    title="Desactivar usuario"
                  >
                    <i class="bi bi-x-circle"></i>Desactivar
                  </button>
                </form>
                <% } else { %>
                <form
                  action="/usuarios/<%= usuario.id %>/activar"
                  method="POST"
                  class="d-inline"
                >
                  <button
                    class="btn btn-success btn-accion"
                    type="submit"
                    title="Activar usuario"
                  >
                    <i class="bi bi-check-circle"></i>Activar
                  </button>
                </form>
                <% } %>
                <form
                  action="/usuarios/<%= usuario.id %>/eliminar"
                  method="POST"
                  class="d-inline"
                  onsubmit="return confirm('¿Estás seguro de eliminar este usuario?')"
                >
                  <button
                    class="btn btn-danger btn-accion"
                    type="submit"
                    title="Eliminar usuario"
                  >
                    <i class="bi bi-trash"></i>Eliminar
                  </button>
                </form>
              </td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
      <div class="text-center mt-4">
        <a
          href="/deshboard"
          class="btn btn-secondary btn-accion"
          style="min-width: 140px"
        >
          <i class="bi bi-arrow-left"></i> Volver al panel
        </a>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
